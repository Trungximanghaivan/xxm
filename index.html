<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>XÆ¯á»NG XI MÄ‚NG</title>

<style>
body{margin:0;font-family:"Times New Roman"}
.hidden{display:none}

/* MENU */
.menu{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:30px;
  background:rgba(0,0,0,0.8);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:flex-star;
  gap:25px;
  z-index:1000;
}
.menu a{
  color:white;
  text-decoration:none;
  font-weight:bold;
  font-size:15px;
  cursor:pointer;
}

/* TRANG CHá»¦ */
#home{
 position:relative;
 margin-top:30px;              /* trá»« chiá»u cao menu */
 height:calc(100vh - 30px);    /* pháº§n cÃ²n láº¡i cá»§a mÃ n hÃ¬nh */
 background:url("anhcty1.png") center/cover no-repeat;
 background-size:cover;
 background-position:center center;
 background-repeat:no-repeat;
 overflow:hidden;
 align-items:center;
 justify-content:center;
color:blue;text-align:center
}
#home h1{padding-top:120px;font-size:50px}
.subtitle {
    font-size: 30px;   /* tÄƒng cá»¡ chá»¯ */
    font-weight: 500;  /* tÃ¹y chá»n */
}
/* CHUNG */
button{padding:4px 10px;font-weight:bold}
.info{text-align:center;font-weight:bold;margin:2px}
h2,h3,p{margin:2px}

/* Báº¢NG */
table{border-collapse:collapse;width:100%}
th,td{border:1px solid #000;font-size:12px;text-align:center;padding:3px}
th{background:#eee}
input{width:28px;border:none;text-align:center}
.total{font-weight:bold;background:#f3f3f3}
.print-val{display:none}

/* HEADER IN */
#print-header{text-align:center;
}
 
/* CHá»® KÃ */
#print-sign {
  margin-top: 10px;
  text-align: right;
  font-size: 12px;
  font-weight:bold
  page-break-inside: avoid;
}

/* IN */
@media print{
@page{size:A4 landscape;margin:8mm}
.menu,button,input,select,.info{display:none!important}
#home,#dataPage{display:none}
#noibo{display:block}

/* HEADER */
.print-header{display:block}
.print-header h2{font-size:18px}
.print-header h3{font-size:14px}

/* IN GIÃ TRá»Š */
input{display:none}
.print-val{display:inline}

/* KHÃ”NG NGáº®T TRANG */
table,tr,td,th{page-break-inside:avoid}
}

#gioithieu{
  position:relative;
  margin-top:30px;
  min-height:calc(100vh - 30px);   /* TRá»ª MENU */
  width:100%;
  box-sizing:border-box;

  background:url("https://images.unsplash.com/photo-1581092334494-9dba1e6e3f48") center center / cover no-repeat;

  padding:20px;
  overflow:hidden;
}


#dataPage{
  position:relative;
  margin-top:30px;
  min-height:calc(100vh - 30px);   /* TRá»ª MENU */
  width:100%;
  box-sizing:border-box;

  background:url("https://images.unsplash.com/photo-1581092334494-9dba1e6e3f48") center center / cover no-repeat;

  padding:20px;
  overflow:hidden;
}

/* ===== GIá»šI THIá»†U â€“ SÆ  Äá»’ ===== */
.org-chart{
display:flex;
flex-direction:column;
align-items:center;
gap:15px;
margin:20px 0
}
.org-chart .row{
display:flex;
gap:20px
}
.box{
border:1px solid #000;
padding:8px 12px;
text-align:center;
min-width:120px;
background:#f9f9f9;
font-weight:bold
}
.top{background:#e0e0e0}

/* LINK TRÃI DÆ¯á»šI */
.gt-links{
margin-top:20px;
font-weight:bold
}
.gt-links div{
margin:6px 0;
cursor:pointer
}
.page{
  margin-top:30px;
  min-height:calc(100vh - 30px);
}
.hidden{
  display:none;
}
.title-org{
  text-align:center;
  color:red;
  font-weight:bold;
}

/* IN A4 */
@media print {

  body{
    margin:0;
  }

  #print-area{
    page-break-inside: avoid;
  }

  #print-header{
    text-align:center;
    margin-bottom:5px;        /* kÃ©o sÃ¡t báº£ng */
    page-break-after: avoid; /* âŒ cáº¥m ngáº¯t sau tiÃªu Ä‘á» */
  }

  #bangChamCong{
    width:100%;
    border-collapse:collapse;
    page-break-inside:auto;  /* âœ… cho phÃ©p báº£ng tá»± ngáº¯t */
  }

  #bangChamCong thead{
    display:table-header-group; /* láº·p header khi sang trang */
  }

  #bangChamCong tr{
    page-break-inside:avoid;
  }

  #print-sign{
    margin-top:20px;
    page-break-inside:avoid;
  }
}
/* =====SCBD THIET Bá»Š EXPLORER ===== */
.explorer{
  display:flex;
  height:100vh;
  border:1px solid #999;
  background:#fff;
}

.title-bdsc{
  text-align:center;
  color:green;
  font-weight:bold;
}

/* Cá»˜T TRÃI */
.tree{
  width:220px;
  border-right:1px solid #ccc;
  padding:10px;
  background:#f3f3f3;
}
.tree .folder{
  padding:6px 8px;
  cursor:pointer;
  font-weight:bold;
}
.tree .folder:hover{
  background:#d9e6f2;
}

/* Cá»˜T PHáº¢I */
.files{
  flex:1;
  padding:10px;
  overflow:auto;
}
.file{
  padding:6px;
  border-bottom:1px solid #eee;
}
.file a{
  text-decoration:none;
  color:#000;
}
.file a:hover{
  text-decoration:underline;
  color:#0055aa;
}

</style>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

</head>

<body>

<!-- MENU -->
<div class="menu">
<a onclick="show('home')">Trang Chá»§</a>
<a onclick="show('gioithieu')">Giá»›i Thiá»‡u</a>
<a onclick="show('bdsctb')">BDSC Thiáº¿t Bá»‹</a>
<a onclick="chamcong()">Cháº¥m CÃ´ng</a>
<a onclick="vaoDuLieu()">Nháº­p Dá»¯ Liá»‡u</a>
</div>

<!-- TRANG CHá»¦ -->
<div id="home" class="page">
<h1>XÆ¯á»NG XI MÄ‚NG</h1>
<p class="subtitle">--Trang Quáº£n LÃ½ Ná»™i Bá»™--</p>
</div>
<!-- GIá»šI THIá»†U -->
<div id="gioithieu" class="page hidden" style="padding:20px">

<h2 class="title-org">
  SÆ  Äá»’ Tá»” CHá»¨C XÆ¯á»NG XI MÄ‚NG
</h2>

<!-- SÆ  Äá»’ -->
<div class="org-chart">

  <div class="box top">Quáº£n Ä‘á»‘c</div>

  <div class="row">
    <div class="box">PhÃ³ quáº£n Ä‘á»‘c<br>Ká»¹ thuáº­t</div>
    <div class="box">PhÃ³ quáº£n Ä‘á»‘c<br>An toÃ n â€“ NhÃ¢n sá»±</div>
  </div>

  <div class="box">TrÆ°á»Ÿng ca sáº£n xuáº¥t</div>

  <div class="row">
    <div class="box">Äá»™i cÆ¡ Ä‘iá»‡n</div>
    <div class="box">Äá»™i váº­n hÃ nh</div>
    <div class="box">Äá»™i Ä‘Ã³ng bao</div>
    <div class="box">Tá»• thá»‘ng kÃª</div>
  </div>
 </div>
</div>

<!-- ===== Sá»¬A CHá»®A THIáº¾T Bá»Š â€“ EXPLORER ===== -->
<div id="bdsctb" class="page hidden">
<h2 class="title-bdsc">
  Sá»¬A CHá»®A & Báº¢O DÆ¯á» NG THIáº¾T Bá»Š
</h2>

  <div class="explorer">

    <!-- Cá»˜T TRÃI â€“ FOLDER -->
    <div class="tree">
      <div class="folder" onclick="openFolder('sc2025')">ğŸ“ NÄƒm 2025</div>
      <div class="folder" onclick="openFolder('sc2026')">ğŸ“ NÄƒm 2026</div>
      <div class="folder" onclick="openFolder('tlkt1')">ğŸ“ TÃ i liá»‡u ká»¹ thuáº­t line1</div>
      <div class="folder" onclick="openFolder('tlkt2')">ğŸ“ TÃ i liá»‡u ká»¹ thuáº­t line2</div>
    </div>

    <!-- Cá»˜T PHáº¢I â€“ FILE -->
    <div class="files" id="fileView">

      <!-- 2025 -->
      <div class="file-group" id="sc2025">
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/KeHoachSuaChua_01_2024.xlsx" target="_blank">
            Káº¿ hoáº¡ch sá»­a chá»¯a
          </a>
        </div>
        <div class="file">
          ğŸ“„ <a href="https://docs.google.com/spreadsheets/d/1-xY2pvgo4A5sHVBQlvd9gfXcKSKFrzvHIMwwRW7Ithc/edit?usp=drivesdk" target="_blank">
            BÃ¡o cÃ¡o sá»­a chá»¯a(tuáº§n/thÃ¡ng/nÄƒm2025)
          </a>
        </div>
      </div>

      <!-- 2026 -->
      <div class="file-group hidden" id="sc2026">
        <div class="file">
          ğŸ“„ <a href="https://1drv.ms/x/c/2ee3992a41898859/IQD4rbv79rjoTqmfwZ82A0WkASTJqF6lcCCYEgdeqbD649U?e=kmd25H" target="_blank">
            NgÃ¢n sÃ¡ch @ Háº¡ng má»¥c sá»­a chá»¯a 2026
          </a>
        </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            Káº¿ hoáº¡ch sá»­a chá»¯a thÃ¡ng 1 Ä‘áº¿n 12 nÄƒm 2026
          </a>
        </div>
        <div class="file">
          ğŸ“„ <a href="https://docs.google.com/spreadsheets/d/1cpXLHdtaaNm0vWtz3PnvIX-6h-BexaF8uXVYwS5_b2I/edit?usp=drivesdk" target="_blank">
            BÃ¡o cÃ¡o sá»­a chá»¯a(tuáº§n/thÃ¡ng/nÄƒm2026)
          </a>
        </div>
      </div>

      <!-- TÃ€I LIá»†U Ká»¸ THUáº¬T LINE1 -->
      <div class="file-group hidden" id="tlkt1">
        <div class="file">
          ğŸ“„ <a href="docs/suachua/huongdan/QuyTrinhBaoDuong.pdf" target="_blank">
            TÃ i liá»‡u 1
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            TÃ i liá»‡u 2
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            TÃ i liá»‡u 3
          </a>
        </div>
      </div>
      <!-- TÃ€I LIá»†U Ká»¸ THUáº¬T LINE2 -->
      <div class="file-group hidden" id="tlkt2">
        <div class="file">
          ğŸ“„ <a href="https://drive.google.com/file/d/18ApxjYg43NbVIT2ITo4v9zIYQ2Gr1_Jt/view?usp=sharing" target="_blank">
            TÃ i liá»‡u Ä‘iá»‡n nghiá»n line2
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="https://drive.google.com/file/d/1-HqQWfTW6WFjns5LkPwt2tTEcE714pgP/view?usp=sharing" target="_blank">
            TÃ i liá»‡u Ä‘iá»‡n Ä‘Ã³ng bao line2
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="https://drive.google.com/file/d/1xGrkiODPqijz7W5jY1R_PLS8y1EeLvAg/view?usp=sharing" target="_blank">
            TÃ i liá»‡u Ä‘iá»‡n nháº­p nguyÃªn váº­t liá»‡u line2
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="https://drive.google.com/file/d/1Jr8Pez92ieCQu31SEO2jtek7iWa6W__h/view?usp=sharing" target="_blank">
            TÃ i liá»‡u Ä‘iá»‡n tráº¡m 22kv-MÃ¡y cáº¯t 6kv
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            TÃ i liá»‡u cÆ¡ cá»¥m nghiá»n line2
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            TÃ i liá»‡u cÆ¡ cá»¥m Ä‘Ã³ng bao line2
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            TÃ i liá»‡u cÆ¡ cá»¥m nháº­p nguyÃªn váº­t liá»‡u line2
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            Forder 1
           </a>
          </div>
        <div class="file">
          ğŸ“„ <a href="docs/suachua/2024/BaoCaoThang1.docx" target="_blank">
            Forder 2
          </a>
        </div>
      </div>
    </div>
  </div>

 
</div>

<!-- Dá»® LIá»†U -->
<div id="dataPage" class="page hidden" style="padding:20px">
<h2>NHáº¬P NHÃ‚N Sá»°</h2>
<div class="info">
Bá»™ pháº­n:
<select id="dl_bp">
<option value="thukho">Thá»§ kho</option>
<option value="codien">CÆ¡ Ä‘iá»‡n</option>
<option value="dongbao">ÄÃ³ng bao</option>
<option value="quanly">Quáº£n lÃ½</option>
</select><br><br>
Há» tÃªn: <input id="dl_ten" style="width:200px"><br><br>
Chá»©c vá»¥: <input id="dl_cv" style="width:200px"><br><br>
<button onclick="luuNS()">ğŸ’¾ LÆ°u</button>
<button onclick="xoaNS()">ğŸ—‘ XoÃ¡</button>
<button onclick="show('home')">â¬… Trang chá»§</button>
</div>
</div>

<!-- Ná»˜I Bá»˜ -->
<div id="noibo" class="page hidden" style="padding:4px">

<button onclick="show('home')">â¬… Trang chá»§</button>
<button onclick="luuWeb()">ğŸ’¾ LÆ°u</button>
<button onclick="taiWeb()">ğŸ“‚ táº£i</button>
<button onclick="window.print()">ğŸ–¨ In</button>
<button onclick="xuatExcel()">ğŸ“Š Xuáº¥t Excel</button>
<!-- HEADER IN -->
<div id="print-area">
  <div id="print-header">
    <div class="title-xuong">XÆ¯á»NG XI MÄ‚NG</div>
    <div class="title-bcc">Báº¢NG CHáº¤M CÃ”NG</div>
    <div class="title-info">
    <span id="p_bp"></span> â€”
    ThÃ¡ng <span id="p_th"></span>/<span id="p_n"></span>
   </div>
 </div>
<div class="info">
Bá»™ pháº­n:
<select id="bophan" onchange="taoBang()">
<option value="thukho">Thá»§ kho</option>
<option value="codien">CÆ¡ Ä‘iá»‡n</option>
<option value="dongbao">ÄÃ³ng bao</option>
<option value="quanly">Quáº£n lÃ½</option>
</select>
ThÃ¡ng <input id="thang" size="2">
NÄƒm <input id="nam" size="4">
<button onclick="taoBang()">Táº¡o</button>
 </div>

 <table id="bangChamCong">
 <thead>
 <tr>
<th rowspan="3">STT</th>
<th rowspan="3">Há» tÃªn</th>
<th rowspan="3">Chá»©c vá»¥</th>
<th colspan="31">NgÃ y</th>
<th rowspan="3">NgÃ y lÃ m</th>
<th rowspan="3">K3</th>
<th rowspan="3">á»m</th>
<th rowspan="3">PhÃ©p</th>
<th rowspan="3">Lá»…</th>
<th rowspan="3">RL</th>
<th rowspan="3">VR</th>
<th rowspan="3">Tá»•ng</th>
</tr>
<tr id="ngay"></tr>
<tr id="thu"></tr>
</thead>
<tbody id="noiDung"></tbody>
</table>

<div id="print-sign">
Quáº£n Ä‘á»‘c XXM:<br><br>â€¦â€¦â€¦â€¦â€¦â€¦â€¦
</div>

</div>

<script>
const home=document.getElementById("home");
const noibo=document.getElementById("noibo");
const dataPage=document.getElementById("dataPage");
const ngay=document.getElementById("ngay");
const thu=document.getElementById("thu");
const noiDung=document.getElementById("noiDung");
const thang=document.getElementById("thang");
const nam=document.getElementById("nam");
const bophan=document.getElementById("bophan");
let nhansu=JSON.parse(localStorage.getItem("NHANSU")||"{}");

function show(pageId){
  document.querySelectorAll(".page").forEach(p=>{
    p.classList.add("hidden");
  });
  document.getElementById(pageId).classList.remove("hidden");
}

function chamcong(){
  let mk = prompt("Nháº­p máº­t kháº©u:");
  if(mk==="123456"){
    show("noibo");
     setThangNamHienTai();
    taoBang();
  }else{
    alert("Sai máº­t kháº©u");
  }
}

function vaoDuLieu(){
  let mk = prompt("Nháº­p máº­t kháº©u:");
  if(mk==="123456"){
    show("dataPage");
  }else{
    alert("Sai máº­t kháº©u");
  }
}


function luuNS(){
let bp=dl_bp.value;
if(!nhansu[bp]) nhansu[bp]=[];
nhansu[bp].push([dl_ten.value,dl_cv.value]);
localStorage.setItem("NHANSU",JSON.stringify(nhansu));
alert("ÄÃ£ lÆ°u nhÃ¢n sá»±");
}

function xoaNS(){
let bp=dl_bp.value;
if(nhansu[bp]&&nhansu[bp].length){nhansu[bp].pop();localStorage.setItem("NHANSU",JSON.stringify(nhansu));}
alert("ÄÃ£ xÃ³a nhÃ¢n sá»±");
}

function taoBang(){
ngay.innerHTML="";thu.innerHTML="";noiDung.innerHTML="";
let th=+thang.value,n=+nam.value;
let soNgay=new Date(n,th,0).getDate();
let map=["CN","T2","T3","T4","T5","T6","T7"];

for(let d=1;d<=soNgay;d++){
ngay.innerHTML+=`<th>${d}</th>`;
thu.innerHTML+=`<th>${map[new Date(n,th-1,d).getDay()]}</th>`;
}

(nhansu[bophan.value]||[]).forEach((p,i)=>{
let r=`<tr><td>${i+1}</td><td>${p[0]}</td><td>${p[1]}</td>`;
for(let d=1;d<=soNgay;d++)
r+=`<td><input oninput="tinh(this)"><span class="print-val"></span></td>`;
r+=`<td class="total nl">0</td><td class="total k3">0</td>
<td class="total om">0</td><td class="total p">0</td>
<td class="total l">0</td><td class="total rl">0</td><td class="total vr">0</td><td class="total t">0</td></tr>`;
noiDung.innerHTML+=r;
});

p_bp.innerText=bophan.options[bophan.selectedIndex].text;
p_th.innerText=th;p_n.innerText=n;
}

function tinh(e){
let r=e.closest("tr"),nl=0,k3=0,om=0,p=0,l=0,rl=0,vr=0;
r.querySelectorAll("input").forEach(i=>{
let v=i.value.toUpperCase().trim();
i.nextElementSibling.innerText=v;
if(v==="1"||v==="2") nl++;
else if(v==="3"){nl++;k3++;}
else if(v==="12") nl+=2;
else if(v==="11/2") nl+=1.5;
else if(v==="21/2") nl+=1.5;
else if(v==="31/2") nl+=1.5;
else if(v==="13"||v==="23"){nl+=2;k3++;}
else if(v==="32"){nl+=2;k3++;}
else if(v==="1/2") nl+=0.5;
else if(v==="O") om++;
else if(v==="P") p++;
else if(v==="L") l++;
else if(v==="RL") rl++;
else if(v==="VR") vr++;
});
r.querySelector(".nl").innerText=nl;
r.querySelector(".k3").innerText=k3;
r.querySelector(".om").innerText=om;
r.querySelector(".p").innerText=p;
r.querySelector(".l").innerText=l;
r.querySelector(".rl").innerText=rl;
r.querySelector(".vr").innerText=vr;
r.querySelector(".t").innerText=nl+om+p+(l*3)+rl;
}


function tinhDong(tr){
  let cong = 0, k3 = 0, om = 0, phep = 0, le = 0, rl = 0, vr = 0;

  tr.querySelectorAll('.ngay').forEach(o=>{
    let v = o.value.trim();

    if(v==="1" || v==="2") cong += 1;
    if(v==="3"){ cong += 1; k3++; }

    if(v==="12") cong += 2;
    if(v==="13" || v==="23" || v==="32"){ cong += 2; k3++; }

    if(v==="1/2") cong += 0.5;

    if(v==="O") om++;
    if(v==="P") phep++;
    if(v==="L") le += 3;
    if(v==="RL") riengl++;
    if(v==="VR") riengol++;
  });

  tr.querySelector('.c_cong').innerText = cong;
  tr.querySelector('.c_k3').innerText   = k3;
  tr.querySelector('.c_om').innerText   = om;
  tr.querySelector('.c_phep').innerText = phep;
  tr.querySelector('.c_le').innerText   = le;
  tr.querySelector('.c_riengl').innerText   = riengl;
  tr.querySelector('.c_riengol').innerText   = riengol;
  tr.querySelector('.c_tong').innerText = cong + le;
}





function loadDuLieu(){
  // sau khi gÃ¡n xong value cho cÃ¡c Ã´ input

  document.querySelectorAll('#bangChamCong tbody tr')
    .forEach(tr => tinhDong(tr));
}


function luuWeb(){
let d=[];
document.querySelectorAll("#noiDung tr").forEach(tr=>{
let r=[];
tr.querySelectorAll("input").forEach(i=>r.push(i.value));
d.push(r);
});
localStorage.setItem(`CC_${bophan.value}_${thang.value}_${nam.value}`,JSON.stringify(d));
}

function taiWeb(){
let d=JSON.parse(localStorage.getItem(`CC_${bophan.value}_${thang.value}_${nam.value}`)||"[]");
document.querySelectorAll("#noiDung tr").forEach((tr,i)=>{
tr.querySelectorAll("input").forEach((inp,j)=>{
if(d[i]){
  inp.value=d[i][j];
  inp.nextElementSibling.innerText=d[i][j];
}
});
// tÃ­nh láº¡i tá»•ng sau khi load
if(tr.querySelector("input")){
  tinh(tr.querySelector("input"));
}
});
}



function xuatExcel(){
  const wb = XLSX.utils.book_new();

  const ws_data = [];

  const soCot = 3 + document.querySelectorAll("#ngay th").length + 5;
  const endCol = XLSX.utils.encode_col(soCot-1);

  // ===== TIÃŠU Äá»€ =====
  ws_data.push([`XÆ¯á»NG XI MÄ‚NG`]);
  ws_data.push([`Báº¢NG CHáº¤M CÃ”NG`]);
  ws_data.push([`Bá»™ pháº­n: ${bophan.options[bophan.selectedIndex].text}  -  ThÃ¡ng ${thang.value}/${nam.value}`]);
  ws_data.push([]);

  // ===== HEADER =====
  const header1 = ["STT","Há» tÃªn","Chá»©c vá»¥"];
  document.querySelectorAll("#ngay th").forEach(th=>header1.push(th.innerText));
  header1.push("NgÃ y lÃ m","K3","á»m","PhÃ©p","Lá»…","RL","VR","Tá»•ng");
  ws_data.push(header1);

  // ===== Dá»® LIá»†U =====
  document.querySelectorAll("#noiDung tr").forEach(tr=>{
    const row=[];
    tr.querySelectorAll("td").forEach(td=>{
      const inp=td.querySelector("input");
      row.push(inp ? inp.value : td.innerText);
    });
    ws_data.push(row);
  });

  // ===== CHá»® KÃ CUá»I Báº¢NG =====
ws_data.push([]);

const signRow = Array(soCot).fill("");
signRow[soCot-2] = "Quáº£n Ä‘á»‘c XXM:";
ws_data.push(signRow);


  const ws = XLSX.utils.aoa_to_sheet(ws_data);

  // ===== MERGE TIÃŠU Äá»€ =====
  ws["!merges"]=[
    {s:{r:0,c:0},e:{r:0,c:soCot-1}},
    {s:{r:1,c:0},e:{r:1,c:soCot-1}},
    {s:{r:2,c:0},e:{r:2,c:soCot-1}},
  ];
   // merge chá»¯ kÃ½ sang pháº£i
  ws["!merges"].push({
    s:{r: ws_data.length-1, c: soCot-2},
    e:{r: ws_data.length-1, c: soCot-1}
  });

  // ===== CÄ‚N Cá»˜T =====
  ws["!cols"]=[
    {wch:5},{wch:25},{wch:18},
    ...Array(31).fill({wch:4}),
    {wch:8},{wch:6},{wch:6},{wch:6},{wch:6},{wch:6},{wch:6},{wch:8}
  ];

  // ===== TRANG IN A4 NGANG =====
  ws["!pageSetup"]={
    paper:9,
    orientation:"landscape",
    fitToHeight:1,
    fitToWidth:1
  };

  XLSX.utils.book_append_sheet(wb,ws,"Bang cham cong");

  XLSX.writeFile(
    wb,
    `Cham_cong_${bophan.value}_${thang.value}_${nam.value}.xlsx`
  );
}

function openFolder(id){
  document.querySelectorAll(".file-group")
    .forEach(f=>f.classList.add("hidden"));

  document.getElementById(id).classList.remove("hidden");
}


function setThangNamHienTai(){
  const now = new Date();
  const thangHT = now.getMonth() + 1; // JS tÃ­nh thÃ¡ng tá»« 0
  const namHT = now.getFullYear();

  document.getElementById("thang").value = thangHT;
  document.getElementById("nam").value = namHT;
}



show("home");
</script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

</body>
</html>
